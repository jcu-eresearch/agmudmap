<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Mud Map: To the Sea of Prosperity, via north Australian expanded agriculture.</title>

    <!-- Font -->
    <link href='http://fonts.googleapis.com/css?family=Ubuntu+Condensed' rel='stylesheet' type='text/css'>

    <!-- Bootstrap core CSS -->
    <link href="../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Leaflet -->
    <link href="../bower_components/leaflet/dist/leaflet.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="cover.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="container-fluid">
        <div class="row header">
            <div class="col-md-6 heading text-center">
                <img class="img-responsive" src="header.jpg" title="Mud Map">
                <p class="lead">To the Sea of Prosperity,<br>via north Australian expanded agriculture.</p>
            </div>
            <div class="intro">
                <div class="col-md-3">
                    <p>Keith Noble is a PhD candidate in the Colleage of Marine and
                        Environmental Sciences, James Cook University, Townsville
                        Campus.  His thesis title is <em>Eyes wide open: Planning a
                        resilient future for North Australian agriculture, come hell or high
                        water.</em></p>
                </div>
                <div class="col-md-3">
                    <p>Keith would like to talk to you about your thoughts and experience
                        with agriculture in the north of Australia, particularly if you are a
                        farmer, grazier, or researcher.  Keith can be contacted at:
                        <a href="mailto:keith.noble2@my.jcu.edu.au">keith.noble2@my.jcu.edu.au</a>
                        or <a class="text-nowrap" href="tel:+61427189160">0427 189 160</a>.
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div id="map"></div>
        </div>
    </div>
    <div class="container-fluid mastfoot">
        <div class="row text-center">
            <a href="http://www.jcu.edu.au"><img src="jcu.png"></a>
            <a href="http://www.terrain.org.au"><img src="terrain.png"></a>
            <a href="http://www.grownorth.com.au"><img src="grownorth.png"></a>
            <div class="promo">
                Want something similar? Developed by the <a
                href="http://eresearch.jcu.edu.au">JCU eResearch Centre</a>.
            </div>
        </div>
    </div>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="../bower_components/leaflet/dist/leaflet.js"></script>
    <script src="data.geojson"></script>
    <script>
        function resize() {
            $('#map').height($(window).height() - $('#map').position().top);
        }
        $(window).resize(resize);
        var map = L.map('map', {
            attributionControl: false,
            minZoom: 2,
            maxZoom: 5,
            crs: L.CRS.Simple,
            center: [0, 0],
            zoom: 3});
        function unproject(point) {
            return map.unproject(point, map.getMaxZoom());
        }
        var imageWidth = 3500,
          imageHeight = 4928,
          imageNorthEast = unproject([imageWidth, 0]),
          imageSouthWest = unproject([0, imageHeight]),
          maxNorthEast = unproject([imageWidth * 1.25, -imageHeight * 0.25]),
          maxSouthWest = unproject([-imageWidth * 0.25, imageHeight * 1.5]);
        map.setMaxBounds(new L.LatLngBounds(maxSouthWest, maxNorthEast));
        L.imageOverlay('map.jpg', new L.LatLngBounds(imageSouthWest, imageNorthEast)).addTo(map);

        // Adding point to map
        function onEachFeature(feature, layer) {
            var popupContent = feature.properties.description + " " + feature.properties.subtitle;
            layer.bindPopup(popupContent);
        }
        L.geoJson(geojson, {
            onEachFeature: onEachFeature,
            pointToLayer: function(feature, latlng) {
                var labelContent = "<h3>" + feature.properties.description + "</h3>";
                if (feature.properties.subtitle) {
                    labelContent += "<p>" + feature.properties.subtitle + "</p>";
                }
                console.log($(labelContent).style('max-width','200px').width());
                return L.marker(unproject([latlng.lng, latlng.lat]), {
                    icon: L.divIcon({
                        className: 'leaflet-label ' + feature.properties.class,
                        html: labelContent,
                        iconSize: L.Point(200, 0)
                        })
                }).addTo(map);
            }
        }).addTo(map);
    </script>
  </body>
</html>

